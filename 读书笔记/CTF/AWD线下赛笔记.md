# AWD线下赛笔记

## 配置路由表

首先调用`ipconfig`查看本机网络状况

```powershell
PS C:\Users\syc> ipconfig
Windows IP 配置
以太网适配器 vEthernet (Default Switch):
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::861:2a51:6e5a:761b%9
   IPv4 地址 . . . . . . . . . . . . : 172.17.126.97
   子网掩码  . . . . . . . . . . . . : 255.255.255.240
   默认网关. . . . . . . . . . . . . :
以太网适配器 以太网:
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::716b:1e8e:e67a:bdf%20
   IPv4 地址 . . . . . . . . . . . . : 10.0.10.2
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . :
以太网适配器 以太网 2:
   媒体状态  . . . . . . . . . . . . : 媒体已断开连接
   连接特定的 DNS 后缀 . . . . . . . :
以太网适配器 VirtualBox Host-Only Network:
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::40de:409b:e37f:34eb%4
   IPv4 地址 . . . . . . . . . . . . : 192.168.56.1
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . :
以太网适配器 VirtualBox Host-Only Network #2:
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::cd1f:a63d:6cee:c094%17
   IPv4 地址 . . . . . . . . . . . . : 192.168.201.2
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . :
无线局域网适配器 本地连接* 1:
   媒体状态  . . . . . . . . . . . . : 媒体已断开连接
   连接特定的 DNS 后缀 . . . . . . . :
无线局域网适配器 本地连接* 3:
   媒体状态  . . . . . . . . . . . . : 媒体已断开连接
   连接特定的 DNS 后缀 . . . . . . . :
以太网适配器 VMware Network Adapter VMnet1:
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::9401:d238:7f61:d7d3%7
   IPv4 地址 . . . . . . . . . . . . : 192.168.61.1
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . :
以太网适配器 VMware Network Adapter VMnet8:
   连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::907b:8932:6a09:c20b%10
   IPv4 地址 . . . . . . . . . . . . : 192.168.159.1
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . :
无线局域网适配器 WLAN:
   连接特定的 DNS 后缀 . . . . . . . :
   IPv6 地址 . . . . . . . . . . . . : 2409:8955:3014:2e39:4438:1682:19e2:8070
   临时 IPv6 地址. . . . . . . . . . : 2409:8955:3014:2e39:6513:5ca8:8df0:e7f
   本地链接 IPv6 地址. . . . . . . . : fe80::4438:1682:19e2:8070%16
   IPv4 地址 . . . . . . . . . . . . : 192.168.43.65
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : fe80::90f0:52ff:fe0e:4b86%16
以太网适配器 蓝牙网络连接:
   媒体状态  . . . . . . . . . . . . : 媒体已断开连接
   连接特定的 DNS 后缀 . . . . . . . :
```

然后调用`route print`查看本机路由表情况

```powershell
PS C:\Users\syc> route print
===========================================================================
接口列表
  9...00 15 5d bf b4 b8 ......Hyper-V Virtual Ethernet Adapter
 20...80 e8 2c 1a 31 4d ......Realtek PCIe GbE Family Controller
 21...08 00 58 00 00 05 ......SSL VPN Client Virtual Network Adapter
  4...0a 00 27 00 00 04 ......VirtualBox Host-Only Ethernet Adapter
 17...0a 00 27 00 00 11 ......VirtualBox Host-Only Ethernet Adapter #2
 25...f2 68 e6 73 9b 9f ......Microsoft Wi-Fi Direct Virtual Adapter
 15...b2 68 e6 73 9b 9f ......Microsoft Wi-Fi Direct Virtual Adapter #3
  7...00 50 56 c0 00 01 ......VMware Virtual Ethernet Adapter for VMnet1
 10...00 50 56 c0 00 08 ......VMware Virtual Ethernet Adapter for VMnet8
 16...b0 68 e6 73 9b 9f ......Realtek RTL8822BE 802.11ac PCIe Adapter
 11...b0 68 e6 73 9b a0 ......Bluetooth Device (Personal Area Network)
  1...........................Software Loopback Interface 1
 19...00 00 00 00 00 00 00 e0 Microsoft Teredo Tunneling Adapter
===========================================================================

IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码          网关       接口   跃点数
          0.0.0.0          0.0.0.0     192.168.43.1    192.168.43.65     35
          0.0.0.0          0.0.0.0      10.0.10.254        10.0.10.2     25
        10.0.10.0    255.255.255.0            在链路上         10.0.10.2    281
        10.0.10.2  255.255.255.255            在链路上         10.0.10.2    281
      10.0.10.255  255.255.255.255            在链路上         10.0.10.2    281
        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    331
        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    331
  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
    172.17.126.96  255.255.255.240            在链路上     172.17.126.97    271
    172.17.126.97  255.255.255.255            在链路上     172.17.126.97    271
   172.17.126.111  255.255.255.255            在链路上     172.17.126.97    271
     192.168.43.0    255.255.255.0            在链路上     192.168.43.65    291
    192.168.43.65  255.255.255.255            在链路上     192.168.43.65    291
   192.168.43.255  255.255.255.255            在链路上     192.168.43.65    291
     192.168.56.0    255.255.255.0            在链路上      192.168.56.1    281
     192.168.56.1  255.255.255.255            在链路上      192.168.56.1    281
   192.168.56.255  255.255.255.255            在链路上      192.168.56.1    281
     192.168.61.0    255.255.255.0            在链路上      192.168.61.1    291
     192.168.61.1  255.255.255.255            在链路上      192.168.61.1    291
   192.168.61.255  255.255.255.255            在链路上      192.168.61.1    291
    192.168.159.0    255.255.255.0            在链路上     192.168.159.1    291
    192.168.159.1  255.255.255.255            在链路上     192.168.159.1    291
  192.168.159.255  255.255.255.255            在链路上     192.168.159.1    291
    192.168.201.0    255.255.255.0            在链路上     192.168.201.2    281
    192.168.201.2  255.255.255.255            在链路上     192.168.201.2    281
  192.168.201.255  255.255.255.255            在链路上     192.168.201.2    281
        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    331
        224.0.0.0        240.0.0.0            在链路上      192.168.56.1    281
        224.0.0.0        240.0.0.0            在链路上     192.168.201.2    281
        224.0.0.0        240.0.0.0            在链路上     172.17.126.97    271
        224.0.0.0        240.0.0.0            在链路上         10.0.10.2    281
        224.0.0.0        240.0.0.0            在链路上     192.168.43.65    291
        224.0.0.0        240.0.0.0            在链路上      192.168.61.1    291
        224.0.0.0        240.0.0.0            在链路上     192.168.159.1    291
  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
  255.255.255.255  255.255.255.255            在链路上      192.168.56.1    281
  255.255.255.255  255.255.255.255            在链路上     192.168.201.2    281
  255.255.255.255  255.255.255.255            在链路上     172.17.126.97    271
  255.255.255.255  255.255.255.255            在链路上         10.0.10.2    281
  255.255.255.255  255.255.255.255            在链路上     192.168.43.65    291
  255.255.255.255  255.255.255.255            在链路上      192.168.61.1    291
  255.255.255.255  255.255.255.255            在链路上     192.168.159.1    291
===========================================================================
永久路由:
  无

IPv6 路由表
===========================================================================
活动路由:
 接口跃点数网络目标                网关
 16     51 ::/0                     fe80::90f0:52ff:fe0e:4b86
  1    331 ::1/128                  在链路上
 19    331 2001::/32                在链路上
 19    331 2001:0:284a:364:181c:cd3e:2097:c0dd/128
                                    在链路上
 16     51 2409:8955:3014:2e39::/64 在链路上
 16    291 2409:8955:3014:2e39:4438:1682:19e2:8070/128
                                    在链路上
 16    291 2409:8955:3014:2e39:6513:5ca8:8df0:e7f/128
                                    在链路上
  4    281 fe80::/64                在链路上
 17    281 fe80::/64                在链路上
  9    271 fe80::/64                在链路上
 20    281 fe80::/64                在链路上
 16    291 fe80::/64                在链路上
  7    291 fe80::/64                在链路上
 10    291 fe80::/64                在链路上
 19    331 fe80::/64                在链路上
  9    271 fe80::861:2a51:6e5a:761b/128
                                    在链路上
 19    331 fe80::181c:cd3e:2097:c0dd/128
                                    在链路上
  4    281 fe80::40de:409b:e37f:34eb/128
                                    在链路上
 16    291 fe80::4438:1682:19e2:8070/128
                                    在链路上
 20    281 fe80::716b:1e8e:e67a:bdf/128
                                    在链路上
 10    291 fe80::907b:8932:6a09:c20b/128
                                    在链路上
  7    291 fe80::9401:d238:7f61:d7d3/128
                                    在链路上
 17    281 fe80::cd1f:a63d:6cee:c094/128
                                    在链路上
  1    331 ff00::/8                 在链路上
  4    281 ff00::/8                 在链路上
 17    281 ff00::/8                 在链路上
  9    271 ff00::/8                 在链路上
 20    281 ff00::/8                 在链路上
 16    291 ff00::/8                 在链路上
  7    291 ff00::/8                 在链路上
 10    291 ff00::/8                 在链路上
 19    331 ff00::/8                 在链路上
===========================================================================
永久路由:
  无
```

关键是看本机有线网卡和无线网卡的网络通信接口号，例如

```powershell
接口列表
  9...00 15 5d bf b4 b8 ......Hyper-V Virtual Ethernet Adapter
 20...80 e8 2c 1a 31 4d ......Realtek PCIe GbE Family Controller
 21...08 00 58 00 00 05 ......SSL VPN Client Virtual Network Adapter
  4...0a 00 27 00 00 04 ......VirtualBox Host-Only Ethernet Adapter
 17...0a 00 27 00 00 11 ......VirtualBox Host-Only Ethernet Adapter #2
 25...f2 68 e6 73 9b 9f ......Microsoft Wi-Fi Direct Virtual Adapter
 15...b2 68 e6 73 9b 9f ......Microsoft Wi-Fi Direct Virtual Adapter #3
  7...00 50 56 c0 00 01 ......VMware Virtual Ethernet Adapter for VMnet1
 10...00 50 56 c0 00 08 ......VMware Virtual Ethernet Adapter for VMnet8
 16...b0 68 e6 73 9b 9f ......Realtek RTL8822BE 802.11ac PCIe Adapter
 11...b0 68 e6 73 9b a0 ......Bluetooth Device (Personal Area Network)
  1...........................Software Loopback Interface 1
 19...00 00 00 00 00 00 00 e0 Microsoft Teredo Tunneling Adapter
```

我们一般都是有线网卡用的是比赛平台的内网环境，无线网卡就是外网环境，所以这个例子中

```powershell
20...80 e8 2c 1a 31 4d ......Realtek PCIe GbE Family Controller
16...b0 68 e6 73 9b 9f ......Realtek RTL8822BE 802.11ac PCIe Adapter
```

有线网卡的接口号是：20，无线网卡的接口号是：16

然后就是清除原来的路由表

```powershell
route delete 0.0.0.0
```

然后默认网络走无线网络的接口

```powershell
route add 0.0.0.0 mask 0.0.0.0 192.168.43.1 metric 1 if 16
```

然后配置比赛内网的网段走有线端口

```powershell
route add 10.0.10.0 mask 255.255.255.0 10.0.10.254 metric 3 if 20
route add 192.168.100.0 mask 255.255.255.0 10.0.10.254 metric 3 if 20
```

## 跳板机and攻击机

可以先用Xshell连接上跳板机然后在跳板机中开启socks5代理

```
SSH -> 隧道 -> 添加 -> 类型（方向）-> Dymaic（Socks4/5）
```

记住跳板机的本地监听端口，然后用Proxifer新建一个代理服务器

```
Profile -> Add -> address: 127.0.0.1 port:刚刚记录的 Type:Socks5 
```

然后自定义网络代理流量规则

**Proxification Rules** 将攻击机的地址填入 **Target Hosts** 然后 **Action** 选择我们刚刚创建的跳板机

这样就完成了基础的网络配置